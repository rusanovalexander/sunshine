(virtual-env) inghero@dsbox-gv20fi:~/data/irwbds/llm/parc/notebooks/PF_Case/pipline_pf_7/sunshine-master$ python check_model.py
============================================================
  GGUF Model Load Diagnostic
============================================================

[1] File check
    Path : /home/inghero/data/irwbds/llm/parc/Ministral-14B-GGUF/Ministral-3-14B-Instruct-2512-Q5_K_M.gguf
    Size : 8.96 GB
    Read permission: yes

[2] Import check
    llama-cpp-python version: 0.3.16

[3] CUDA / GPU check
    GPU: NVIDIA A100-PCIE-40GB, [Insufficient Permissions], [Insufficient Permissions]

[4] Model load check
    n_gpu_layers=-1, n_ctx=512, n_batch=512
ggml_cuda_init: GGML_CUDA_FORCE_MMQ:    no
ggml_cuda_init: GGML_CUDA_FORCE_CUBLAS: no
ggml_cuda_init: found 1 CUDA devices:
  Device 0: NVIDIA A100-PCIE-40GB MIG 4g.20gb, compute capability 8.0, VMM: yes
llama_model_load_from_file_impl: using device CUDA0 (NVIDIA A100-PCIE-40GB MIG 4g.20gb) - 19718 MiB free
llama_model_loader: loaded meta data with 53 key-value pairs and 363 tensors from /home/inghero/data/irwbds/llm/parc/Ministral-14B-GGUF/Ministral-3-14B-Instruct-2512-Q5_K_M.gguf (version GGUF V3 (latest))
llama_model_loader: Dumping metadata keys/values. Note: KV overrides do not apply in this output.
llama_model_loader: - kv   0:                       general.architecture str              = mistral3
llama_model_loader: - kv   1:                               general.type str              = model
llama_model_loader: - kv   2:                               general.name str              = ministral-14B-Instruct-2512
llama_model_loader: - kv   3:                            general.version str              = 3.0
llama_model_loader: - kv   4:                       general.organization str              = Mistral AI
llama_model_loader: - kv   5:                           general.finetune str              = 2512
llama_model_loader: - kv   6:                           general.basename str              = Ministral
llama_model_loader: - kv   7:                        general.description str              = The Ministral 3 family is designed fo...
llama_model_loader: - kv   8:                         general.size_label str              = 14B
llama_model_loader: - kv   9:                            general.license str              = apache-2.0
llama_model_loader: - kv  10:                                general.url str              = https://huggingface.co/mistralai/Mini...
llama_model_loader: - kv  11:                           general.repo_url str              = https://huggingface.co/mistralai/Mini...
llama_model_loader: - kv  12:                   general.base_model.count u32              = 1
llama_model_loader: - kv  13:                  general.base_model.0.name str              = Ministral 3 14B Base 2512
llama_model_loader: - kv  14:               general.base_model.0.version str              = 2512
llama_model_loader: - kv  15:          general.base_model.0.organization str              = Mistralai
llama_model_loader: - kv  16:              general.base_model.0.repo_url str              = https://huggingface.co/mistralai/Mini...
llama_model_loader: - kv  17:                               general.tags arr[str,1]       = ["mistral-common"]
llama_model_loader: - kv  18:                          general.languages arr[str,11]      = ["en", "fr", "es", "de", "it", "pt", ...
llama_model_loader: - kv  19:                       mistral3.block_count u32              = 40
llama_model_loader: - kv  20:                    mistral3.context_length u32              = 262144
llama_model_loader: - kv  21:                  mistral3.embedding_length u32              = 5120
llama_model_loader: - kv  22:               mistral3.feed_forward_length u32              = 16384
llama_model_loader: - kv  23:              mistral3.attention.head_count u32              = 32
llama_model_loader: - kv  24:           mistral3.attention.head_count_kv u32              = 8
llama_model_loader: - kv  25:                    mistral3.rope.freq_base f32              = 1000000000.000000
llama_model_loader: - kv  26:  mistral3.attention.layer_norm_rms_epsilon f32              = 0.000010
llama_model_loader: - kv  27:              mistral3.attention.key_length u32              = 128
llama_model_loader: - kv  28:            mistral3.attention.value_length u32              = 128
llama_model_loader: - kv  29:              mistral3.rope.dimension_count u32              = 128
llama_model_loader: - kv  30:                 mistral3.rope.scaling.type str              = yarn
llama_model_loader: - kv  31:               mistral3.rope.scaling.factor f32              = 16.000000
llama_model_loader: - kv  32:       mistral3.rope.scaling.yarn_beta_fast f32              = 32.000000
llama_model_loader: - kv  33:       mistral3.rope.scaling.yarn_beta_slow f32              = 1.000000
llama_model_loader: - kv  34:  mistral3.rope.scaling.yarn_log_multiplier f32              = 1.000000
llama_model_loader: - kv  35: mistral3.rope.scaling.original_context_length u32              = 16384
llama_model_loader: - kv  36:       mistral3.attention.temperature_scale f32              = 0.100000
llama_model_loader: - kv  37:                       tokenizer.ggml.model str              = gpt2
llama_model_loader: - kv  38:                         tokenizer.ggml.pre str              = tekken
Exception ignored on calling ctypes callback function: <function llama_log_callback at 0x7fcbd3dbfeb0>
Traceback (most recent call last):
  File "/layers/dap-buildpacks_pip-install/site-packages/virtual-env/lib/python3.10/site-packages/llama_cpp/_logger.py", line 39, in llama_log_callback
    print(text.decode("utf-8"), end="", flush=True, file=sys.stderr)
UnicodeDecodeError: 'utf-8' codec can't decode byte 0xc4 in position 128: invalid continuation byte
llama_model_loader: - kv  40:                tokenizer.ggml.bos_token_id u32              = 1
llama_model_loader: - kv  41:                tokenizer.ggml.eos_token_id u32              = 2
llama_model_loader: - kv  42:            tokenizer.ggml.unknown_token_id u32              = 0
llama_model_loader: - kv  43:            tokenizer.ggml.padding_token_id u32              = 11
llama_model_loader: - kv  44:                      tokenizer.ggml.tokens arr[str,131072]  = ["<unk>", "<s>", "</s>", "[INST]", "[...
llama_model_loader: - kv  45:                      tokenizer.ggml.scores arr[i32,131072]  = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, ...
llama_model_loader: - kv  46:                  tokenizer.ggml.token_type arr[i32,131072]  = [3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, ...
llama_model_loader: - kv  47:                        mistral3.vocab_size u32              = 131072
llama_model_loader: - kv  48:               tokenizer.ggml.add_bos_token bool             = true
llama_model_loader: - kv  49:               tokenizer.ggml.add_eos_token bool             = false
llama_model_loader: - kv  50:                    tokenizer.chat_template str              = {#- Default system message if no syst...
llama_model_loader: - kv  51:               general.quantization_version u32              = 2
llama_model_loader: - kv  52:                          general.file_type u32              = 17
llama_model_loader: - type  f32:   81 tensors
llama_model_loader: - type q5_K:  241 tensors
llama_model_loader: - type q6_K:   41 tensors
print_info: file format = GGUF V3 (latest)
print_info: file type   = Q5_K - Medium
print_info: file size   = 8.95 GiB (5.69 BPW) 
llama_model_load: error loading model: error loading model architecture: unknown model architecture: 'mistral3'
llama_model_load_from_file_impl: failed to load model
    ERROR loading model: Failed to load model from file: /home/inghero/data/irwbds/llm/parc/Ministral-14B-GGUF/Ministral-3-14B-Instruct-2512-Q5_K_M.gguf
Exception ignored in: <function LlamaModel.__del__ at 0x7fcbd3c38040>
Traceback (most recent call last):
  File "/layers/dap-buildpacks_pip-install/site-packages/virtual-env/lib/python3.10/site-packages/llama_cpp/_internals.py", line 86, in __del__
    self.close()
  File "/layers/dap-buildpacks_pip-install/site-packages/virtual-env/lib/python3.10/site-packages/llama_cpp/_internals.py", line 78, in close
    if self.sampler is not None:
AttributeError: 'LlamaModel' object has no attribute 'sampler'

FAILED: model did not load.

Troubleshooting tips:
  - Try --n-gpu-layers 0 to rule out a CUDA/VRAM issue
  - Try --n-ctx 512 if context size causes OOM
  - Re-download the GGUF if the file size looks wrong
